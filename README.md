# ancestral

Recommendation Systems (RS) have achieved substantial evolution in this 21st-century Information Era, with no exception in the biological domain. These systems combine various computational techniques to select personalized items based on users' interests. Users' interest in a specific item can be measured through explicit or implicit feedback. In the former case, the user provides their opinion, for instance, through a star rating system (zero, didn't like it; 5, liked it a lot). In the latter case, the user's opinion is inferred from their activities, such as clicking on an item. Following this approach, RS can be divided into Collaborative Filtering (CF), which uses the similarity between users' ratings to provide recommendations, Content-Based (CB), which uses the similarity between item characteristics, and Hybrid, a combination of both CF and CB approaches. 
Autism Spectrum Disorder (ASD) is a neurological and developmental disorder that affects how people interact with others, behave, communicate, and learn. While autism can be diagnosed at any age, individuals typically develop ASD-related symptoms when they are 12 to 18 months old, and the diagnosis is usually made by the age of 2, described as a "developmental disorder". Due to the lack of clinical and epidemiological evidence for a cure for ASD, researchers have focused on better understanding ASD and advancing in predicting and preventing risks. The heritability of ASD has been estimated at 50%, indicating that genetic factors are the primary contributors to the etiology of ASD.
This thesis aims to investigate and develop Recommender systems for recommending biomedical entities related to autism, with the purpose of providing effective tools for personalized and relevant information discovery to researchers and healthcare professionals. The study explores three distinct data splitting approaches and evaluates their impact on the recommendation system's performance. Relevant biomedical data, including information on autism-related ancestral diseases, PubMed articles, and author details, were collected and processed. A Python program, using the Surprise library, was developed as the foundation for the recommendation system. Evaluation metric results reveal valuable insights into the system's performance in different scenarios. This work contributes to the understanding of challenges in recommending biomedical entities related to autism and underscores the importance of data splitting strategies. Future research is encouraged to explore additional techniques and strategies to enhance the accuracy and relevance of recommendations in complex contexts.

The first we will compile a list of diseases related to Autism Spectrum Disorder (ASD). To achieve this goal, we will use the Disease Ontology (DO), a disease ontology, as the basis to identify both ancestral and ASD-related diseases. In this phase, we will employ the Molecular Entity Relations (MER) tool, which will enable us to identify ancestral diseases and diseases directly related to autism. Additionally, we will explore the use of the DiShIn tool (Disease Similarity Inference for Human), which will calculate the semantic similarity between entities in the Disease Ontology, with a focus on diseases related to ASD.

DO (Disease ontology) is a formal ontology of human disease. The Disease Ontology project was developed to respond to the need for an ontology built specifically to cover the full spectrum of disease concepts annotated in biomedical repositories in an ontological framework extensible to meet community needs.

This program is designed to provide you with the names and DOIDs of your ancestors when you input the name or DOID of a disease. To use it, simply enter the disease name or DOID and the program will deliver the relevant information about your ancestors.

https://raw.githubusercontent.com/DiseaseOntology/HumanDiseaseOntology/main/src/ontology/doid.owl

Please download the executable from the link above and ensure that all files are in the same folder before running.

To run the program, simply execute the file named AncestryTracker.sh in the command line.

After obtaining our disease and its ancestors, using Retrieve_articles_and_find_gene_in_articles.ipynb, we will download all articles separately related to our diseases. Following this, we will search for gene names in all the articles, resulting in a dataset with the genes found and their respective corresponding articles. Next, the other program, create_dataset.ipynb, is utilized to create the dataset. The process is repeated for each of the diseases until the final step, which involves merging all the datasets. Once the complete datasets are available, a recommendation system is implemented using the Surprise library, utilizing the code from Recommendation systems Code.ipynb. Tests were carried out with other libraries aimed at constructing recommendation systems, such as LightFM, TensorRec, Lenskit, and Crab. Regrettably, these libraries did not perform optimally for this project. They demonstrated lower efficiency, compatibility issues with our data, or were in a testing phase with regard to the Python language. For example, Lenskit was still in a testing phase for the Python language. It was at this point that the Surprise library stood out, delivering the best results in terms of compatibility with our data and processing efficiency. 

From the dataset that was created, it was split into training and testing sets in three different ways: random split 80/20, data was randomly divided into a training set (80\%) and a test set (20\%). This approach was chosen for its simplicity and ease of implementation. However, random splitting can result in high variability in results as it does not take into account the actual data distribution or specific characteristics. Autism-Focused Split (Single Author per Test), articles related to the "autism disorder" were selected for the test set, with only one article from each author who contributed multiple articles on the disease. The aim was to avoid a dominant bias from a single author with multiple autism-related articles. This provides a more balanced evaluation of the recommendation system regarding authors associated with autism. Articles related to other diseases were assigned to the training set. Finally, Disease-Based Split, meaning the dataset was split into training and testing sets, where the testing set consisted of rows with the disease "autism disorder" and the rest were in the training set. In this case, the "article\textunderscorecount count" column was removed and replaced with a new column called "num\textunderscorecount articles," which would represent the number of articles each author has per disease. This approach can be useful to understand how the recommendation system deals with specific cases and whether it is capable of making relevant recommendations based on information about the number of articles each author has written about the disease. It's a way to evaluate the effectiveness of the system in a more personalized and targeted scenario, which may be relevant in medical or scientific recommendation applications.

For both approaches, we used the KNNWithMeans model (a collaborative filtering model that uses the nearest neighbors approach to make item rating predictions) to build a recommendation system.  Additionally, we employed GridSearchCV (a technique that automates the search for a model's best hyper parameters, allowing the model to be fine-tuned for optimized performance) to find the best parameters for the model.

In this case, we are performing a grid search with cross-validation (cv=5) to find the best values for the parameter k, which represents the number of neighbors to be considered by the model. Then evaluate the model's performance using metrics such as RMSE (Root Mean Squared Error) and MAE (Mean Absolute Error) during cross-validation to select the best parameters.

This approach allow to find the best hyperparameters for the KNNWithMeans model, ensuring that it is configured in the best possible way to make accurate and relevant article recommendation predictions, taking into account the specific context of each data splitting approach.

Finally, in this repository, we also have the codes used for data analysis: dataset_analise.ipynb containing analyses of the dataset and autor_genes.ipynb focusing more on genes analysis.
